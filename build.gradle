plugins {
    id 'application'
    id 'org.beryx.jlink' version '3.1.1'
}

repositories { mavenCentral() }

java {
    toolchain { languageVersion = JavaLanguageVersion.of(21) }
}

/* ---- JavaFX ë²„ì „/í”Œë«í¼ ë¶„ê¸° ---- */
ext {
    javafxVer = '21.0.4'
    def os = org.gradle.internal.os.OperatingSystem.current()
    javafxClassifier = os.isMacOsX()
            ? (System.getProperty("os.arch").contains("aarch64") ? "mac-aarch64" : "mac")
            : (os.isWindows() ? "win" : "linux")
}

application {
    mainClass = 'com.example.organizer.App'
}

/* ---- JavaFX ì˜ì¡´ì„±: base / graphics / controls ë§Œ ----
   (FXML ì•ˆ ì“°ë©´ fxml ì œê±°í•´ì•¼ Windows jlinkì—ì„œ ì•ˆ í„°ì§) */
dependencies {
    implementation "org.openjfx:javafx-base:${javafxVer}:${javafxClassifier}"
    implementation "org.openjfx:javafx-graphics:${javafxVer}:${javafxClassifier}"
    implementation "org.openjfx:javafx-controls:${javafxVer}:${javafxClassifier}"
    // ë§Œì•½ FXML ì‹¤ì œ ì‚¬ìš©ì‹œ â†‘ ìœ„ 3ê°œ + ì•„ë˜ ì¤„ ì¶”ê°€
    // implementation "org.openjfx:javafx-fxml:${javafxVer}:${javafxClassifier}"

    implementation "org.xerial:sqlite-jdbc:3.46.0.1"
}

jlink {
    options = ['--strip-debug','--compress','2','--no-header-files','--no-man-pages']
    launcher { name = 'TodoProgram' }

    // ğŸ”§ Windows Runnerì—ì„œ ëª¨ë“ˆ ëª» ì°¾ëŠ” ë¬¸ì œë¥¼ ì˜ˆë°©
    addExtraDependencies("javafx")

    // (ì„ íƒ) ë” í™•ì‹¤íˆ: ìë™ ìƒì„±ë˜ëŠ” module-infoì— í•„ìš”í•œ ëª¨ë“ˆ ëª…ì‹œ
    mergedModule {
        additive = true
        requires 'javafx.base'
        requires 'javafx.graphics'
        requires 'javafx.controls'
        // FXML ì‚¬ìš©í•  ë•Œë§Œ
        // requires 'javafx.fxml'
        requires 'java.sql'
    }
}
